<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no"/>
<meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>SparkPlay</title>
<link rel="apple-touch-icon" href="icona.png">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">

<style>
/* --- GRAFICA ORIGINALE ZIP (style.css) --- */
:root{
  --bg0:#070B14; --bg1:#0B1220; --ink:#EAF2FF; --muted:#A9B7D6; --line:rgba(255,255,255,.10);
  --accent:#3F5EF6; --gold:#FFB300; --radius:26px; --shadow:0 30px 70px rgba(0,0,0,.45);
}
body{
  margin:0; min-height:100vh;
  background: radial-gradient(1200px 800px at 30% 10%, rgba(63,94,246,.22), transparent 60%),
              radial-gradient(900px 700px at 80% 30%, rgba(255,179,0,.10), transparent 60%),
              linear-gradient(180deg, var(--bg0), var(--bg1));
  font-family: Inter, system-ui, sans-serif; color:var(--ink);
}
.sp-root{ max-width: 800px; margin: 0 auto; padding: 20px; } /* Allargato per PC */
.sp-shell{ border: 1px solid var(--line); border-radius: var(--radius); background: rgba(255,255,255,.02); box-shadow: var(--shadow); overflow: hidden; }
.sp-top{ padding: 16px; border-bottom: 1px solid var(--line); display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,.03); }
.brand{ font-weight: 1000; letter-spacing: 1.4px; font-size: 14px; }
.card{ background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03)); border: 1px solid var(--line); border-radius: 22px; padding: 20px; margin-bottom: 15px; }
.btn{ border: none; border-radius: 20px; padding: 16px; font-weight: 900; cursor: pointer; transition: 0.2s; font-size: 16px; }
.btn-primary{ background: linear-gradient(180deg, var(--accent), #334ed7); color: white; width: 100%; box-shadow: 0 10px 30px rgba(63,94,246,.3); }
.btn-ghost{ background: transparent; color: #BFD0FF; border: 1px solid var(--line); }
.step.active{ background: linear-gradient(90deg, rgba(63,94,246,.18), transparent); border-left: 4px solid var(--accent); padding-left: 10px; margin: 5px 0; }
.step.dim{ opacity: 0.4; padding-left: 14px; }
.orb{ width: 56px; height: 56px; border-radius: 18px; background: rgba(63,94,246,.2); border: 1px solid var(--accent); display: flex; align-items: center; justify-content: center; font-size: 28px; margin-bottom: 15px; }
</style>
</head>
<body>
<div id="SPARKPLAY_APP" class="sp-root"></div>

<script>
(()=>{"use strict";
/* --- LOGICA ORIGINALE AGGIORNATA --- */
const DB={
  small:[
    {id:"s01",badge:"ğŸŒ™",title:"Segnale Perduto",story:"La base ha perso il segnale. Senza di te, la galassia resta al buio.",goal:"Riaccendere lâ€™antenna della base.",prop:"un calzino",steps:["Trova lâ€™antenna (un calzino) e stringila forte.","Portala nella tua base (un tappeto).","Fai 3 bip lenti: bip... bip... bip..."],finale:"Gran Finale ğŸŒŸ: Segnale tornato, base salva!",q:"CuriositÃ  Spaziale ğŸ¤”: A chi manderesti il primo messaggio?"}
  ],
  legend: {
    title: "Sincronia Stellare ğŸ¤",
    story: "Per ripartire serve la spinta di due astronauti perfettamente coordinati.",
    goal: "Completare il movimento insieme.",
    steps: ["Prenditi per mano con il genitore.","Fate 5 passi lentissimi insieme verso la base.","Contate '3... 2... 1... Decollo!' ad alta voce insieme."],
    finale: "Gran Finale ğŸŒŸ: Siete un equipaggio formidabile!",
    q: "CuriositÃ  Spaziale ğŸ¤”: Chi di voi due Ã¨ il pilota piÃ¹ calmo?"
  }
};

let s = { fsm:"WELCOME", audio:false, step:0, quest:null };

function speak(text){ if(s.audio){ speechSynthesis.cancel(); const u=new SpeechSynthesisUtterance(text); u.lang="it-IT"; u.rate=0.85; speechSynthesis.speak(u); } }

function render(){
  const root = document.getElementById("SPARKPLAY_APP");
  if(s.fsm === "WELCOME"){
    root.innerHTML = `
      <div class="sp-shell">
        <div class="sp-top"><div class="brand">SPARKPLAY ğŸš€</div><button class="btn-ghost" style="padding:8px 12px;border-radius:999px" onclick="toggleAudio()">${s.audio?'ğŸ”Š':'ğŸ”ˆ'}</button></div>
        <div style="padding:20px;">
          <div class="orb">ğŸš€</div>
          <h1>Benvenuto Comandante</h1>
          <p>Pronto per le missioni reali di oggi? Ricorda: muoviti con calma.</p>
          <button class="btn btn-primary" onclick="start()">AVVIA MISSIONE</button>
          <div style="height:12px"></div>
          <button class="btn btn-ghost" style="width:100%" onclick="startLegend()">MISSIONE SPECIALE ğŸ¤</button>
        </div>
      </div>`;
  } else {
    const q = s.quest;
    root.innerHTML = `
      <div class="sp-shell">
        <div class="sp-top"><div class="brand">MISSIONE</div><button class="btn-ghost" style="padding:8px 12px;border-radius:999px" onclick="toggleAudio()">${s.audio?'ğŸ”Š':'ğŸ”ˆ'}</button></div>
        <div style="padding:20px;">
          <div class="card"><b>Contesto:</b> ${q.story}</div>
          <div class="card"><b>Obiettivo:</b> ${q.goal}</div>
          <div class="card" style="background:rgba(0,0,0,0.2)">
            ${q.steps.map((txt,i)=>`<div class="step ${i===s.step?'active':'dim'}">${i+1}. ${txt}</div>`).join("")}
          </div>
          <button class="btn btn-primary" onclick="next()">
            ${s.step < q.steps.length-1 ? 'PROSSIMO PASSO' : 'COMPLETATO âœ…'}
          </button>
        </div>
      </div>`;
  }
}

window.toggleAudio = () => { s.audio = !s.audio; render(); if(s.audio) speak("Audio attivato"); };
window.start = () => { s.fsm="QUEST"; s.quest=DB.small[0]; s.step=0; render(); speak(s.quest.steps[0]); };
window.startLegend = () => { s.fsm="QUEST"; s.quest=DB.legend; s.step=0; render(); speak(s.quest.steps[0]); };
window.next = () => {
  if(s.step < s.quest.steps.length - 1){
    s.step++; render(); speak(s.quest.steps[s.step]);
  } else {
    speak(s.quest.finale + " " + s.quest.q);
    alert(s.quest.finale + "\n\n" + s.quest.q);
    s.fsm="WELCOME"; render();
  }
};

render();
})();
</script>
</body>
</html>
